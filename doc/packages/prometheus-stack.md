# 'prometheus-stack' Package

## Description

A package for a Prometheus stack, a collection of Kubernetes manifests, Grafana dashboards, and Prometheus rules
combined with documentation and scripts to provide easy to operate end-to-end Kubernetes cluster monitoring with
Prometheus using the Prometheus Operator.

## Values

| Name                                                                                                     | Type   | Default                                                                                                | Description                                                                                                                                            |
|----------------------------------------------------------------------------------------------------------|--------|--------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| prometheus-stack.grafana.enabled                                                                         | bool   | false                                                                                                  | Grafana enabled flag                                                                                                                                   |
| prometheus-stack.grafana.image.registry                                                                  | string |                                                                                                        | Image registry                                                                                                                                         |
| prometheus-stack.grafana.image.repository                                                                | string |                                                                                                        | Image repository                                                                                                                                       |
| prometheus-stack.grafana.image.tag                                                                       | string |                                                                                                        | Image tag                                                                                                                                              |
| prometheus-stack.grafana.ingress.host                                                                    | string | prometheus-stack-grafana.\<environment\>.\<project\>.\<organization\>.local:<ingressHttpsPort>         | Ingress host                                                                                                                                           |
| prometheus-stack.grafana.web.externalUrl                                                                 | string | https://prometheus-stack-grafana.\<environment\>.\<project\>.\<organization\>.local:<ingressHttpsPort> | Web external URL                                                                                                                                       |
| prometheus-stack.grafana.auth.oidc.enabled                                                               | bool   |                                                                                                        | OIDC enabled flag                                                                                                                                      |
| prometheus-stack.grafana.auth.oidc.providers.generic.name                                                | string |                                                                                                        | Generic OIDC connector name                                                                                                                            |
| prometheus-stack.grafana.auth.oidc.providers.generic.apiUrl                                              | string |                                                                                                        | Generic OIDC API URL                                                                                                                                   |
| prometheus-stack.grafana.auth.oidc.providers.generic.authUrl                                             | string |                                                                                                        | Generic OIDC auth URL                                                                                                                                  |
| prometheus-stack.grafana.auth.oidc.providers.generic.tokenUrl                                            | string |                                                                                                        | Generic OIDC token URL                                                                                                                                 |
| prometheus-stack.grafana.auth.oidc.providers.generic.clientId                                            | string |                                                                                                        | Generic OIDC auth client ID                                                                                                                            |
| prometheus-stack.grafana.auth.oidc.providers.generic.clientSecret                                        | string |                                                                                                        | Generic OIDC auth client secret                                                                                                                        |
| prometheus-stack.grafana.auth.oidc.providers.generic.scopes                                              | string |                                                                                                        | Generic OIDC scopes                                                                                                                                    |
| prometheus-stack.grafana.auth.oidc.providers.generic.roleAttributePath                                   | string |                                                                                                        | Generic OIDC JMESPath expression                                                                                                                       |
| prometheus-stack.grafana.auth.oidc.providers.microsoft.name                                              | string |                                                                                                        | Microsoft OIDC connector name                                                                                                                          |
| prometheus-stack.grafana.auth.oidc.providers.microsoft.tenant                                            | string |                                                                                                        | Microsoft OIDC tenant ID                                                                                                                               |
| prometheus-stack.grafana.auth.oidc.providers.microsoft.clientId                                          | string |                                                                                                        | Microsoft OIDC auth client ID                                                                                                                          |
| prometheus-stack.grafana.auth.oidc.providers.microsoft.clientSecret                                      | string |                                                                                                        | Microsoft OIDC auth client secret                                                                                                                      |
| prometheus-stack.alertmanager.enabled                                                                    | bool   | false                                                                                                  | Alert Manager enabled flag                                                                                                                             |
| prometheus-stack.alertmanager.smtp.enabled                                                               | bool   | false                                                                                                  | Are notifications by mail enabled                                                                                                                      |
| prometheus-stack.alertmanager.smtp.host                                                                  | string |                                                                                                        | Host for the mail account                                                                                                                              |
| prometheus-stack.alertmanager.smtp.email                                                                 | string |                                                                                                        | Email to login                                                                                                                                         |
| prometheus-stack.alertmanager.smtp.password                                                              | string |                                                                                                        | Password/app. password to login                                                                                                                        |
| prometheus-stack.alertmanager.receivers.teams.enabled                                                    | bool   | false                                                                                                  | Teams notifications enabled flag                                                                                                                       |
| prometheus-stack.alertmanager.receivers.teams.configurations[`{i}`].name                                 | string |                                                                                                        | Receiver name for this teams webhook grouping                                                                                                          |
| prometheus-stack.alertmanager.receivers.teams.configurations[`{i}`].webhook[`{i}`].url                   | string |                                                                                                        | Webhook URL                                                                                                                                            |
| prometheus-stack.alertmanager.receivers.teams.configurations[`{i}`].webhook[`{i}`].sendResolved          | bool   | false                                                                                                  | Should we send a 'resolved' notification                                                                                                               |
| prometheus-stack.alertmanager.receivers.mail.enabled                                                     | bool   | false                                                                                                  | Mail notifications enabled flag                                                                                                                        |
| prometheus-stack.alertmanager.receivers.mail.configurations[`{i}`].name                                  | string |                                                                                                        | Receiver name for this mail account grouping                                                                                                           |
| prometheus-stack.alertmanager.receivers.mail.configurations[`{i}`].to[`{i}`].mailAddress                 | string |                                                                                                        | Mail address to send the notifications to                                                                                                              |
| prometheus-stack.alertmanager.receivers.mail.configurations[`{i}`].to[`{i}`].sendResolved                | bool   | false                                                                                                  | Should we send a 'resolved' notification                                                                                                               |
| prometheus-stack.alertmanager.timeInterval.enabled                                                       | bool   | false                                                                                                  | Time Interval enabled flag                                                                                                                             |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].name                                         | string |                                                                                                        | Name of the interval                                                                                                                                   |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].times[`{i}`].startTime | string |                                                                                                        | Start time of the interval in HH:MM format (ex: 17:00)                                                                                                 |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].times[`{i}`].endTime   | string |                                                                                                        | End time of the interval in HH:MM format (ex: 24:00)                                                                                                   |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].weekdays               | list   | []                                                                                                     | Weekdays of the interval (ex: ['monday:wednesday', 'sunday'])                                                                                          |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].daysOfMonths           | list   | []                                                                                                     | Days of Months of the interval. Can be negative (ex: ['1:5', '-3:-1'])                                                                                 |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].months                 | list   | []                                                                                                     | Months of the interval (ex: ['1:3', 'may:august', 'december'])                                                                                         |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].years                  | list   | []                                                                                                     | Years of the interval (ex: ['2020:2022', '2030'])                                                                                                      |
| prometheus-stack.alertmanager.timeInterval.intervals[`{i}`].configurations[`{i}`].location               | string | America/Montreal                                                                                       | Location of the interval in IANA format (Local or UTC also supported)                                                                                  |
| prometheus-stack.alertmanager.route.enabled                                                              | bool   | false                                                                                                  | Route enabled flag                                                                                                                                     |
| prometheus-stack.alertmanager.route.defaultReceiver                                                      | string |                                                                                                        | Fallback receiver if no child routes worked. Must match the alertmanager.receivers.XX.configurations.name                                              |
| prometheus-stack.alertmanager.route.defaultGroupBy                                                       | string | [namespace]                                                                                            | Group notifications based on the labels provided (Use [...] to disable grouping)                                                                       |
| prometheus-stack.alertmanager.route.defaultGroupWait                                                     | string | 30s                                                                                                    | Time period before sending notifications to group them                                                                                                 |
| prometheus-stack.alertmanager.route.defaultGroupInterval                                                 | string | 5m                                                                                                     | Time period before sending a notification about new alerts that are added to a group of alerts for which an initial notification has already been sent |
| prometheus-stack.alertmanager.route.defaultRepeatInterval                                                | string | 4h                                                                                                     | Time period before sending a notification again if it has already been sent successfully                                                               |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].receiver                                          | string |                                                                                                        | Receiver for this route. Must match the alertmanager.receivers.XX.configurations.name                                                                  |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].groupBy                                           | string |                                                                                                        | If omitted, inherit the value of alertmanager.route.defaultGroupBy                                                                                     |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].groupWait                                         | string |                                                                                                        | If omitted, inherit the value of alertmanager.route.defaultGroupWait                                                                                   |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].groupInterval                                     | string |                                                                                                        | If omitted, inherit the value of alertmanager.route.defaultGroupInterval                                                                               |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].repeatInterval                                    | string |                                                                                                        | If omitted, inherit the value of alertmanager.route.defaultRepeatInterval                                                                              |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].continue                                          | bool   | false                                                                                                  | If true and matching, it will continue on other nodes, else it will stop on it                                                                         |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].activeIntervals[`{i}`]                            | list   | []                                                                                                     | Interval when this route must be active. Must match the timeIntervals.intervals.name                                                                   |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].muteIntervals[`{i}`]                              | list   | []                                                                                                     | Interval when this route must be muted. Must match the timeIntervals.intervals.name                                                                    |
| prometheus-stack.alertmanager.route.childRoutes[`{i}`].matchers[`{i}`]                                   | list   | []                                                                                                     | UTF-8 matcher (ex: severity = "critical", alertname = "Watchdog") https://prometheus.io/docs/alerting/latest/configuration/#matcher                    |
| prometheus-stack.alertmanager.additionalAlertRules.enabled                                               | bool   | false                                                                                                  | Additional Alert Rules enabled flag                                                                                                                    |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].groupName                                | string |                                                                                                        | Name of the group for these alerts                                                                                                                     |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].name                        | string |                                                                                                        | Name of the alert                                                                                                                                      |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].expression                  | string |                                                                                                        | Alert expression                                                                                                                                       |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].for                         | string |                                                                                                        | Duration that the expression must remain true for the alert to trigger                                                                                 |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].severity                    | string |                                                                                                        | Severity of the alert (critical, error, warning, info)                                                                                                 |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].summary                     | string |                                                                                                        | Summary of the alert                                                                                                                                   |
| prometheus-stack.alertmanager.additionalAlertRules.rules[`{i}`].rules[`{i}`].description                 | string |                                                                                                        | Description of the alert                                                                                                                               |
